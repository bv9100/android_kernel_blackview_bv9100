#include <linux/string.h>
#include <linux/kernel.h>

#include "lcm_drv.h"

/* ------------------------------------------------------------------------- */
/* Local Constants                                                           */
/* ------------------------------------------------------------------------- */

#define FRAME_WIDTH (1080)
#define FRAME_HEIGHT (2340)

#define REGFLAG_DELAY 0xAB
#define REGFLAG_END_OF_TABLE 0xAA

/* ------------------------------------------------------------------------- */
/* Local Variables                                                           */
/* ------------------------------------------------------------------------- */

static LCM_UTIL_FUNCS lcm_util;

#define SET_RESET_PIN(v) (lcm_util.set_reset_pin(v))
#define UDELAY(n) (lcm_util.udelay(n))
#define MDELAY(n) (lcm_util.mdelay(n))

/* ------------------------------------------------------------------------- */
/* Local Functions                                                           */
/* ------------------------------------------------------------------------- */

#define dsi_set_cmdq_V2(cmd, count, ppara, force_update) \
		lcm_util.dsi_set_cmdq_V2(cmd, count, ppara, force_update)
#define dsi_set_cmdq(pdata, queue_size, force_update) \
		lcm_util.dsi_set_cmdq(pdata, queue_size, force_update)
#define wrtie_cmd(cmd) \
		lcm_util.dsi_write_cmd(cmd)
#define write_regs(addr, pdata, byte_nums) \
		lcm_util.dsi_write_regs(addr, pdata, byte_nums)
#define read_reg(cmd) \
		lcm_util.dsi_dcs_read_lcm_reg(cmd)
#define read_reg_v2(cmd, buffer, buffer_size) \
		lcm_util.dsi_dcs_read_lcm_reg_v2(cmd, buffer, buffer_size)
#define set_gpio_lcd_enp(cmd) \
		lcm_util.set_gpio_lcd_enp_bias(cmd)
#define set_gpio_lcd_enn(cmd) \
		lcm_util.set_gpio_lcd_enn_bias(cmd)
#define set_gpio_tp_incell_rst(cmd) \
		lcm_util.set_gpio_tp_incell_rst(cmd)

extern int fts_write_reg(u8 addr, u8 value);

extern int RT5081_db_pos_neg_setting_by_i2c(int mdelay);
extern int PMU_db_pos_neg_disable_delay(int ms);
extern int PMU_db_pos_neg_setting_delay_hct(int ms, int vol);

struct LCM_setting_table
{
	unsigned int cmd;
	unsigned char count;
	unsigned char para_list[64];
};

static void push_table(struct LCM_setting_table *table, unsigned int count,
					   unsigned char force_update)
{
	unsigned int i;

	for (i = 0; i < count; i++)
	{

		unsigned cmd;
		cmd = table[i].cmd;

		switch (cmd)
		{

		case REGFLAG_DELAY:
			MDELAY(table[i].count);
			break;

		case REGFLAG_END_OF_TABLE:
			break;

		default:
			dsi_set_cmdq_V2(cmd, table[i].count,
							table[i].para_list, force_update);
		}
	}
}

/* ------------------------------------------------------------------------- */
/* LCM Tables                                                                */
/* ------------------------------------------------------------------------- */

static struct LCM_setting_table lcm_init_setting[] = {
	{0x01, 0, {}},
	{REGFLAG_DELAY, 200, {}},
	{0x00, 1, {0x00}},
	{0xFF, 1, {0x87}},
	{0xFF, 1, {0x19}},
	{0xFF, 1, {0x01}},
	{0x00, 1, {0x80}},
	{0xFF, 1, {0x87}},
	{0xFF, 1, {0x19}},
	{0x00, 1, {0x82}},
	{0xA4, 1, {0x29}},
	{0xA4, 1, {0x23}},
	{0x00, 1, {0x80}},
	{0xA7, 1, {0x03}},
	{0x00, 1, {0x82}},
	{0xA7, 1, {0x11}},
	{0xA7, 1, {0x01}},
	{0x00, 1, {0x90}},
	{0xC3, 1, {0x0C}},
	{0xC3, 1, {0x00}},
	{0xC3, 1, {0x00}},
	{0xC3, 1, {0x01}},
	{0x00, 1, {0xA0}},
	{0xC3, 1, {0x31}},
	{0xC3, 1, {0x21}},
	{0xC3, 1, {0x02}},
	{0xC3, 1, {0x10}},
	{0xC3, 1, {0x01}},
	{0xC3, 1, {0x20}},
	{0xC3, 1, {0x12}},
	{0x00, 1, {0xB3}},
	{0xC5, 1, {0x08}},
	{0x00, 1, {0x80}},
	{0xC2, 1, {0x82}},
	{0xC2, 1, {0x01}},
	{0xC2, 1, {0x20}},
	{0xC2, 1, {0x56}},
	{0x00, 1, {0xA0}},
	{0xC2, 1, {0x00}},
	{0xC2, 1, {0x00}},
	{0xC2, 1, {0x00}},
	{0xC2, 1, {0x24}},
	{0xC2, 1, {0x98}},
	{0xC2, 1, {0x01}},
	{0xC2, 1, {0x00}},
	{0xC2, 1, {0x00}},
	{0xC2, 1, {0x24}},
	{0xC2, 1, {0x98}},
	{0xC2, 1, {0x02}},
	{0xC2, 1, {0x00}},
	{0xC2, 1, {0x00}},
	{0xC2, 1, {0x24}},
	{0xC2, 1, {0x98}},
	{0x00, 1, {0xB0}},
	{0xC2, 1, {0x03}},
	{0xC2, 1, {0x00}},
	{0xC2, 1, {0x00}},
	{0xC2, 1, {0x24}},
	{0xC2, 1, {0x98}},
	{0xC2, 1, {0x00}},
	{0xC2, 1, {0x02}},
	{0xC2, 1, {0x03}},
	{0xC2, 1, {0x00}},
	{0xC2, 1, {0x80}},
	{0x00, 1, {0xE0}},
	{0xC2, 1, {0x33}},
	{0xC2, 1, {0x33}},
	{0xC2, 1, {0x73}},
	{0xC2, 1, {0x33}},
	{0xC2, 1, {0x33}},
	{0xC2, 1, {0x33}},
	{0xC2, 1, {0x00}},
	{0xC2, 1, {0x10}},
	{0x00, 1, {0xFA}},
	{0xC2, 1, {0x23}},
	{0xC2, 1, {0xFF}},
	{0xC2, 1, {0x23}},
	{0x00, 1, {0x80}},
	{0xCB, 1, {0x00}},
	{0xCB, 1, {0x01}},
	{0xCB, 1, {0x00}},
	{0xCB, 1, {0x00}},
	{0xCB, 1, {0xFD}},
	{0xCB, 1, {0x01}},
	{0xCB, 1, {0x00}},
	{0xCB, 1, {0x00}},
	{0xCB, 1, {0x00}},
	{0xCB, 1, {0x00}},
	{0xCB, 1, {0xFD}},
	{0xCB, 1, {0x01}},
	{0xCB, 1, {0x00}},
	{0xCB, 1, {0x01}},
	{0xCB, 1, {0x00}},
	{0xCB, 1, {0x03}},
	{0x00, 1, {0x90}},
	{0xCB, 1, {0x00}},
	{0xCB, 1, {0x00}},
	{0xCB, 1, {0x00}},
	{0xCB, 1, {0x00}},
	{0xCB, 1, {0xFC}},
	{0xCB, 1, {0x00}},
	{0xCB, 1, {0x00}},
	{0xCB, 1, {0x00}},
	{0xCB, 1, {0x00}},
	{0xCB, 1, {0x00}},
	{0xCB, 1, {0xFF}},
	{0xCB, 1, {0x00}},
	{0xCB, 1, {0x00}},
	{0xCB, 1, {0x00}},
	{0xCB, 1, {0x00}},
	{0xCB, 1, {0x03}},
	{0x00, 1, {0xA0}},
	{0xCB, 1, {0x00}},
	{0xCB, 1, {0x00}},
	{0xCB, 1, {0x00}},
	{0xCB, 1, {0x00}},
	{0x00, 1, {0xB0}},
	{0xCB, 1, {0x55}},
	{0xCB, 1, {0x55}},
	{0xCB, 1, {0x55}},
	{0xCB, 1, {0x57}},
	{0x00, 1, {0x80}},
	{0xCC, 1, {0x09}},
	{0xCC, 1, {0x29}},
	{0xCC, 1, {0x00}},
	{0xCC, 1, {0x23}},
	{0xCC, 1, {0x00}},
	{0xCC, 1, {0x0A}},
	{0xCC, 1, {0x00}},
	{0xCC, 1, {0x00}},
	{0xCC, 1, {0x09}},
	{0xCC, 1, {0x08}},
	{0xCC, 1, {0x07}},
	{0xCC, 1, {0x06}},
	{0xCC, 1, {0x00}},
	{0xCC, 1, {0x00}},
	{0xCC, 1, {0x00}},
	{0xCC, 1, {0x00}},
	{0x00, 1, {0x90}},
	{0xCC, 1, {0x00}},
	{0xCC, 1, {0x18}},
	{0xCC, 1, {0x16}},
	{0xCC, 1, {0x17}},
	{0xCC, 1, {0x00}},
	{0xCC, 1, {0x1C}},
	{0xCC, 1, {0x1D}},
	{0xCC, 1, {0x1E}},
	{0x00, 1, {0x80}},
	{0xCD, 1, {0x09}},
	{0xCD, 1, {0x00}},
	{0xCD, 1, {0x02}},
	{0xCD, 1, {0x02}},
	{0xCD, 1, {0x00}},
	{0xCD, 1, {0x0A}},
	{0xCD, 1, {0x00}},
	{0xCD, 1, {0x00}},
	{0xCD, 1, {0x09}},
	{0xCD, 1, {0x08}},
	{0xCD, 1, {0x07}},
	{0xCD, 1, {0x06}},
	{0xCD, 1, {0x00}},
	{0xCD, 1, {0x00}},
	{0xCD, 1, {0x00}},
	{0xCD, 1, {0x00}},
	{0x00, 1, {0x90}},
	{0xCD, 1, {0x00}},
	{0xCD, 1, {0x18}},
	{0xCD, 1, {0x16}},
	{0xCD, 1, {0x17}},
	{0xCD, 1, {0x00}},
	{0xCD, 1, {0x1C}},
	{0xCD, 1, {0x1D}},
	{0xCD, 1, {0x1E}},
	{0x00, 1, {0xA0}},
	{0xCC, 1, {0x09}},
	{0xCC, 1, {0x29}},
	{0xCC, 1, {0x02}},
	{0xCC, 1, {0x23}},
	{0xCC, 1, {0x00}},
	{0xCC, 1, {0x0A}},
	{0xCC, 1, {0x00}},
	{0xCC, 1, {0x00}},
	{0xCC, 1, {0x06}},
	{0xCC, 1, {0x07}},
	{0xCC, 1, {0x08}},
	{0xCC, 1, {0x09}},
	{0xCC, 1, {0x00}},
	{0xCC, 1, {0x00}},
	{0xCC, 1, {0x00}},
	{0xCC, 1, {0x00}},
	{0x00, 1, {0xB0}},
	{0xCC, 1, {0x00}},
	{0xCC, 1, {0x18}},
	{0xCC, 1, {0x16}},
	{0xCC, 1, {0x17}},
	{0xCC, 1, {0x00}},
	{0xCC, 1, {0x1C}},
	{0xCC, 1, {0x1D}},
	{0xCC, 1, {0x1E}},
	{0x00, 1, {0xA0}},
	{0xCD, 1, {0x09}},
	{0xCD, 1, {0x00}},
	{0xCD, 1, {0x02}},
	{0xCD, 1, {0x02}},
	{0xCD, 1, {0x00}},
	{0xCD, 1, {0x0A}},
	{0xCD, 1, {0x00}},
	{0xCD, 1, {0x00}},
	{0xCD, 1, {0x06}},
	{0xCD, 1, {0x07}},
	{0xCD, 1, {0x08}},
	{0xCD, 1, {0x09}},
	{0xCD, 1, {0x00}},
	{0xCD, 1, {0x00}},
	{0xCD, 1, {0x00}},
	{0xCD, 1, {0x00}},
	{0x00, 1, {0xB0}},
	{0xCD, 1, {0x00}},
	{0xCD, 1, {0x18}},
	{0xCD, 1, {0x16}},
	{0xCD, 1, {0x17}},
	{0xCD, 1, {0x00}},
	{0xCD, 1, {0x1C}},
	{0xCD, 1, {0x1D}},
	{0xCD, 1, {0x1E}},
	{0x00, 1, {0x80}},
	{0xC0, 1, {0x00}},
	{0xC0, 1, {0x79}},
	{0xC0, 1, {0x00}},
	{0xC0, 1, {0x6D}},
	{0xC0, 1, {0x00}},
	{0xC0, 1, {0x10}},
	{0xC0, 1, {0x01}},
	{0xC0, 1, {0x00}},
	{0xC0, 1, {0x00}},
	{0x00, 1, {0x90}},
	{0xC0, 1, {0x00}},
	{0xC0, 1, {0x79}},
	{0xC0, 1, {0x00}},
	{0xC0, 1, {0x6D}},
	{0xC0, 1, {0x00}},
	{0xC0, 1, {0x10}},
	{0x00, 1, {0x89}},
	{0xC0, 1, {0x01}},
	{0x00, 1, {0xA0}},
	{0xC0, 1, {0x01}},
	{0xC0, 1, {0x05}},
	{0xC0, 1, {0x00}},
	{0xC0, 1, {0x3B}},
	{0xC0, 1, {0x00}},
	{0xC0, 1, {0x10}},
	{0x00, 1, {0xB0}},
	{0xC0, 1, {0x00}},
	{0xC0, 1, {0x79}},
	{0xC0, 1, {0x02}},
	{0xC0, 1, {0x2C}},
	{0xC0, 1, {0x10}},
	{0x00, 1, {0xC1}},
	{0xC0, 1, {0x00}},
	{0xC0, 1, {0xAE}},
	{0xC0, 1, {0x00}},
	{0xC0, 1, {0x88}},
	{0xC0, 1, {0x00}},
	{0xC0, 1, {0x74}},
	{0xC0, 1, {0x00}},
	{0xC0, 1, {0xCC}},
	{0x00, 1, {0xCA}},
	{0xC0, 1, {0x80}},
	{0x00, 1, {0xD7}},
	{0xC0, 1, {0x00}},
	{0xC0, 1, {0x74}},
	{0xC0, 1, {0x00}},
	{0xC0, 1, {0x71}},
	{0xC0, 1, {0x00}},
	{0xC0, 1, {0x10}},
	{0x00, 1, {0xA5}},
	{0xC1, 1, {0x00}},
	{0xC1, 1, {0x56}},
	{0xC1, 1, {0x00}},
	{0xC1, 1, {0x02}},
	{0x00, 1, {0x82}},
	{0xCE, 1, {0x01}},
	{0xCE, 1, {0x09}},
	{0xCE, 1, {0x00}},
	{0xCE, 1, {0xD8}},
	{0xCE, 1, {0x00}},
	{0xCE, 1, {0xD8}},
	{0xCE, 1, {0x00}},
	{0xCE, 1, {0x90}},
	{0xCE, 1, {0x00}},
	{0xCE, 1, {0x90}},
	{0xCE, 1, {0x0D}},
	{0xCE, 1, {0x0E}},
	{0xCE, 1, {0x09}},
	{0x00, 1, {0x90}},
	{0xCE, 1, {0x00}},
	{0xCE, 1, {0x82}},
	{0xCE, 1, {0x0D}},
	{0xCE, 1, {0x5C}},
	{0xCE, 1, {0x00}},
	{0xCE, 1, {0x82}},
	{0xCE, 1, {0x80}},
	{0xCE, 1, {0x09}},
	{0x00, 1, {0xA0}},
	{0xCE, 1, {0x00}},
	{0xCE, 1, {0x00}},
	{0xCE, 1, {0x00}},
	{0x00, 1, {0xB0}},
	{0xCE, 1, {0x11}},
	{0xCE, 1, {0x00}},
	{0xCE, 1, {0xB0}},
	{0x00, 1, {0xD1}},
	{0xCE, 1, {0x00}},
	{0xCE, 1, {0x0A}},
	{0xCE, 1, {0x01}},
	{0xCE, 1, {0x01}},
	{0xCE, 1, {0x00}},
	{0xCE, 1, {0x5E}},
	{0xCE, 1, {0x01}},
	{0x00, 1, {0xE1}},
	{0xCE, 1, {0x08}},
	{0xCE, 1, {0x02}},
	{0xCE, 1, {0x15}},
	{0xCE, 1, {0x02}},
	{0xCE, 1, {0x15}},
	{0xCE, 1, {0x02}},
	{0xCE, 1, {0x15}},
	{0xCE, 1, {0x00}},
	{0xCE, 1, {0x2C}},
	{0xCE, 1, {0x00}},
	{0xCE, 1, {0x62}},
	{0x00, 1, {0xF1}},
	{0xCE, 1, {0x17}},
	{0xCE, 1, {0x0B}},
	{0xCE, 1, {0x0F}},
	{0xCE, 1, {0x00}},
	{0xCE, 1, {0xAE}},
	{0xCE, 1, {0x01}},
	{0xCE, 1, {0x3B}},
	{0xCE, 1, {0x01}},
	{0xCE, 1, {0x60}},
	{0x00, 1, {0xB0}},
	{0xCF, 1, {0x00}},
	{0xCF, 1, {0x00}},
	{0xCF, 1, {0x6C}},
	{0xCF, 1, {0x70}},
	{0x00, 1, {0xB5}},
	{0xCF, 1, {0x05}},
	{0xCF, 1, {0x05}},
	{0xCF, 1, {0x35}},
	{0xCF, 1, {0x39}},
	{0x00, 1, {0xC0}},
	{0xCF, 1, {0x08}},
	{0xCF, 1, {0x08}},
	{0xCF, 1, {0xCA}},
	{0xCF, 1, {0xCE}},
	{0x00, 1, {0xC5}},
	{0xCF, 1, {0x00}},
	{0xCF, 1, {0x00}},
	{0xCF, 1, {0x08}},
	{0xCF, 1, {0x0C}},
	{0x00, 1, {0xA1}},
	{0xB3, 1, {0x04}},
	{0xB3, 1, {0x38}},
	{0xB3, 1, {0x09}},
	{0xB3, 1, {0x24}},
	{0xB3, 1, {0xC0}},
	{0xB3, 1, {0xF8}},
	{0x00, 1, {0x82}},
	{0xC5, 1, {0x4B}},
	{0xC5, 1, {0x4B}},
	{0xC5, 1, {0x3C}},
	{0xC5, 1, {0x3C}},
	{0xC5, 1, {0x00}},
	{0xC5, 1, {0x60}},
	{0xC5, 1, {0x0C}},
	{0x00, 1, {0x00}},
	{0xD8, 1, {0x2B}},
	{0xD8, 1, {0x2B}},
	{0x00, 1, {0x00}},
	{0xD9, 1, {0x00}},
	{0xD9, 1, {0x91}},
	{0xD9, 1, {0x91}},
	{0x00, 1, {0xA3}},
	{0xC5, 1, {0x1B}},
	{0x00, 1, {0xA9}},
	{0xC5, 1, {0x21}},
	{0x00, 1, {0x86}},
	{0xC3, 1, {0x00}},
	{0xC3, 1, {0x00}},
	{0xC3, 1, {0x00}},
	{0x00, 1, {0x89}},
	{0xF5, 1, {0x5F}},
	{0x00, 1, {0x96}},
	{0xF5, 1, {0x5F}},
	{0x00, 1, {0xA6}},
	{0xF5, 1, {0x5F}},
	{0x00, 1, {0xB1}},
	{0xF5, 1, {0x1E}},
	{0x00, 1, {0x81}},
	{0xF5, 1, {0x5F}},
	{0xF5, 1, {0x5F}},
	{0x00, 1, {0x86}},
	{0xF5, 1, {0x5F}},
	{0xF5, 1, {0x5F}},
	{0x00, 1, {0xAA}},
	{0xF5, 1, {0x8E}},
	{0x00, 1, {0x85}},
	{0xC4, 1, {0x1E}},
	{0x00, 1, {0xB7}},
	{0xCE, 1, {0x2B}},
	{0xCE, 1, {0x05}},
	{0x00, 1, {0x90}},
	{0xC5, 1, {0x83}},
	{0x00, 1, {0x92}},
	{0xC5, 1, {0x63}},
	{0x00, 1, {0xE8}},
	{0xC0, 1, {0x40}},
	{0x00, 1, {0x87}},
	{0xC4, 1, {0x40}},
	{0x00, 1, {0x9B}},
	{0xF5, 1, {0x8D}},
	{0xF5, 1, {0x8C}},
	{0xF5, 1, {0x8D}},
	{0xF5, 1, {0x8A}},
	{0x00, 1, {0x91}},
	{0xF5, 1, {0xED}},
	{0xF5, 1, {0x8C}},
	{0x00, 1, {0x95}},
	{0xF5, 1, {0x8A}},
	{0x00, 1, {0x98}},
	{0xF5, 1, {0xEB}},
	{0x00, 1, {0x85}},
	{0xA7, 1, {0x0F}},
	{0x00, 1, {0x00}},
	{0xE1, 1, {0x00}},
	{0xE1, 1, {0x03}},
	{0xE1, 1, {0x09}},
	{0xE1, 1, {0x10}},
	{0xE1, 1, {0x24}},
	{0xE1, 1, {0x1A}},
	{0xE1, 1, {0x22}},
	{0xE1, 1, {0x28}},
	{0xE1, 1, {0x32}},
	{0xE1, 1, {0x04}},
	{0xE1, 1, {0x39}},
	{0xE1, 1, {0x40}},
	{0xE1, 1, {0x45}},
	{0xE1, 1, {0x4A}},
	{0xE1, 1, {0x8F}},
	{0xE1, 1, {0x4F}},
	{0xE1, 1, {0x57}},
	{0xE1, 1, {0x5D}},
	{0xE1, 1, {0x64}},
	{0xE1, 1, {0x4D}},
	{0xE1, 1, {0x6A}},
	{0xE1, 1, {0x71}},
	{0xE1, 1, {0x78}},
	{0xE1, 1, {0x7F}},
	{0xE1, 1, {0xA1}},
	{0xE1, 1, {0x87}},
	{0xE1, 1, {0x8C}},
	{0xE1, 1, {0x91}},
	{0xE1, 1, {0x96}},
	{0xE1, 1, {0x87}},
	{0xE1, 1, {0x9D}},
	{0xE1, 1, {0xA4}},
	{0xE1, 1, {0xAD}},
	{0xE1, 1, {0xB3}},
	{0xE1, 1, {0x7C}},
	{0xE1, 1, {0xB9}},
	{0xE1, 1, {0xC0}},
	{0xE1, 1, {0xC4}},
	{0xE1, 1, {0xC6}},
	{0xE1, 1, {0x17}},
	{0x00, 1, {0x00}},
	{0xE2, 1, {0x00}},
	{0xE2, 1, {0x03}},
	{0xE2, 1, {0x09}},
	{0xE2, 1, {0x10}},
	{0xE2, 1, {0x24}},
	{0xE2, 1, {0x1A}},
	{0xE2, 1, {0x22}},
	{0xE2, 1, {0x28}},
	{0xE2, 1, {0x32}},
	{0xE2, 1, {0xC4}},
	{0xE2, 1, {0x39}},
	{0xE2, 1, {0x40}},
	{0xE2, 1, {0x45}},
	{0xE2, 1, {0x4A}},
	{0xE2, 1, {0x8F}},
	{0xE2, 1, {0x4F}},
	{0xE2, 1, {0x57}},
	{0xE2, 1, {0x5D}},
	{0xE2, 1, {0x64}},
	{0xE2, 1, {0x4D}},
	{0xE2, 1, {0x6A}},
	{0xE2, 1, {0x6F}},
	{0xE2, 1, {0x76}},
	{0xE2, 1, {0x7D}},
	{0xE2, 1, {0xA1}},
	{0xE2, 1, {0x85}},
	{0xE2, 1, {0x8A}},
	{0xE2, 1, {0x8F}},
	{0xE2, 1, {0x94}},
	{0xE2, 1, {0x87}},
	{0xE2, 1, {0x9B}},
	{0xE2, 1, {0xA2}},
	{0xE2, 1, {0xAB}},
	{0xE2, 1, {0xB1}},
	{0xE2, 1, {0x7C}},
	{0xE2, 1, {0xB7}},
	{0xE2, 1, {0xBE}},
	{0xE2, 1, {0xC2}},
	{0xE2, 1, {0xC4}},
	{0xE2, 1, {0x17}},
	{0x00, 1, {0x00}},
	{0xE3, 1, {0x00}},
	{0xE3, 1, {0x03}},
	{0xE3, 1, {0x09}},
	{0xE3, 1, {0x10}},
	{0xE3, 1, {0x39}},
	{0xE3, 1, {0x1A}},
	{0xE3, 1, {0x22}},
	{0xE3, 1, {0x28}},
	{0xE3, 1, {0x32}},
	{0xE3, 1, {0xEF}},
	{0xE3, 1, {0x3A}},
	{0xE3, 1, {0x40}},
	{0xE3, 1, {0x46}},
	{0xE3, 1, {0x4B}},
	{0xE3, 1, {0x79}},
	{0xE3, 1, {0x4F}},
	{0xE3, 1, {0x57}},
	{0xE3, 1, {0x5E}},
	{0xE3, 1, {0x65}},
	{0xE3, 1, {0xEC}},
	{0xE3, 1, {0x6B}},
	{0xE3, 1, {0x73}},
	{0xE3, 1, {0x7A}},
	{0xE3, 1, {0x82}},
	{0xE3, 1, {0xC0}},
	{0xE3, 1, {0x8B}},
	{0xE3, 1, {0x90}},
	{0xE3, 1, {0x96}},
	{0xE3, 1, {0x9D}},
	{0xE3, 1, {0xBF}},
	{0xE3, 1, {0xA6}},
	{0xE3, 1, {0xB0}},
	{0xE3, 1, {0xBE}},
	{0xE3, 1, {0xC7}},
	{0xE3, 1, {0x10}},
	{0xE3, 1, {0xD3}},
	{0xE3, 1, {0xE4}},
	{0xE3, 1, {0xF3}},
	{0xE3, 1, {0xFF}},
	{0xE3, 1, {0x57}},
	{0x00, 1, {0x00}},
	{0xE4, 1, {0x00}},
	{0xE4, 1, {0x03}},
	{0xE4, 1, {0x09}},
	{0xE4, 1, {0x10}},
	{0xE4, 1, {0x39}},
	{0xE4, 1, {0x1B}},
	{0xE4, 1, {0x22}},
	{0xE4, 1, {0x28}},
	{0xE4, 1, {0x32}},
	{0xE4, 1, {0x6F}},
	{0xE4, 1, {0x3A}},
	{0xE4, 1, {0x40}},
	{0xE4, 1, {0x46}},
	{0xE4, 1, {0x4B}},
	{0xE4, 1, {0x79}},
	{0xE4, 1, {0x4F}},
	{0xE4, 1, {0x57}},
	{0xE4, 1, {0x5E}},
	{0xE4, 1, {0x65}},
	{0xE4, 1, {0xEC}},
	{0xE4, 1, {0x6B}},
	{0xE4, 1, {0x71}},
	{0xE4, 1, {0x78}},
	{0xE4, 1, {0x80}},
	{0xE4, 1, {0xC0}},
	{0xE4, 1, {0x89}},
	{0xE4, 1, {0x8E}},
	{0xE4, 1, {0x94}},
	{0xE4, 1, {0x9B}},
	{0xE4, 1, {0xBF}},
	{0xE4, 1, {0xA4}},
	{0xE4, 1, {0xAE}},
	{0xE4, 1, {0xBC}},
	{0xE4, 1, {0xC5}},
	{0xE4, 1, {0x10}},
	{0xE4, 1, {0xD1}},
	{0xE4, 1, {0xE4}},
	{0xE4, 1, {0xF3}},
	{0xE4, 1, {0xFF}},
	{0xE4, 1, {0x57}},
	{0x00, 1, {0x00}},
	{0xE5, 1, {0x00}},
	{0xE5, 1, {0x03}},
	{0xE5, 1, {0x08}},
	{0xE5, 1, {0x0E}},
	{0xE5, 1, {0x1B}},
	{0xE5, 1, {0x18}},
	{0xE5, 1, {0x20}},
	{0xE5, 1, {0x26}},
	{0xE5, 1, {0x2F}},
	{0xE5, 1, {0x92}},
	{0xE5, 1, {0x37}},
	{0xE5, 1, {0x3E}},
	{0xE5, 1, {0x43}},
	{0xE5, 1, {0x48}},
	{0xE5, 1, {0xCE}},
	{0xE5, 1, {0x4D}},
	{0xE5, 1, {0x54}},
	{0xE5, 1, {0x5B}},
	{0xE5, 1, {0x61}},
	{0xE5, 1, {0x3B}},
	{0xE5, 1, {0x67}},
	{0xE5, 1, {0x6E}},
	{0xE5, 1, {0x74}},
	{0xE5, 1, {0x7B}},
	{0xE5, 1, {0xD9}},
	{0xE5, 1, {0x82}},
	{0xE5, 1, {0x87}},
	{0xE5, 1, {0x8B}},
	{0xE5, 1, {0x90}},
	{0xE5, 1, {0xC9}},
	{0xE5, 1, {0x95}},
	{0xE5, 1, {0x9C}},
	{0xE5, 1, {0xA3}},
	{0xE5, 1, {0xA7}},
	{0xE5, 1, {0xCB}},
	{0xE5, 1, {0xAC}},
	{0xE5, 1, {0xB1}},
	{0xE5, 1, {0xB4}},
	{0xE5, 1, {0xB5}},
	{0xE5, 1, {0x53}},
	{0x00, 1, {0x00}},
	{0xE6, 1, {0x00}},
	{0xE6, 1, {0x03}},
	{0xE6, 1, {0x08}},
	{0xE6, 1, {0x0E}},
	{0xE6, 1, {0x1B}},
	{0xE6, 1, {0x19}},
	{0xE6, 1, {0x20}},
	{0xE6, 1, {0x26}},
	{0xE6, 1, {0x2F}},
	{0xE6, 1, {0x92}},
	{0xE6, 1, {0x37}},
	{0xE6, 1, {0x3E}},
	{0xE6, 1, {0x43}},
	{0xE6, 1, {0x48}},
	{0xE6, 1, {0xCE}},
	{0xE6, 1, {0x4D}},
	{0xE6, 1, {0x54}},
	{0xE6, 1, {0x5B}},
	{0xE6, 1, {0x61}},
	{0xE6, 1, {0x3B}},
	{0xE6, 1, {0x67}},
	{0xE6, 1, {0x6C}},
	{0xE6, 1, {0x72}},
	{0xE6, 1, {0x79}},
	{0xE6, 1, {0xD9}},
	{0xE6, 1, {0x80}},
	{0xE6, 1, {0x85}},
	{0xE6, 1, {0x89}},
	{0xE6, 1, {0x8E}},
	{0xE6, 1, {0xC9}},
	{0xE6, 1, {0x93}},
	{0xE6, 1, {0x9A}},
	{0xE6, 1, {0xA1}},
	{0xE6, 1, {0xA5}},
	{0xE6, 1, {0xCB}},
	{0xE6, 1, {0xAA}},
	{0xE6, 1, {0xAF}},
	{0xE6, 1, {0xB2}},
	{0xE6, 1, {0xB3}},
	{0xE6, 1, {0x53}},
	{0x00, 1, {0xB0}},
	{0xF5, 1, {0x00}},
	{0x00, 1, {0xC1}},
	{0xB6, 1, {0x09}},
	{0xB6, 1, {0x89}},
	{0xB6, 1, {0x68}},
	{0x00, 1, {0x80}},
	{0xB4, 1, {0x0A}},
	{0x00, 1, {0x8C}},
	{0xC3, 1, {0x01}},
	{0x00, 1, {0x8E}},
	{0xC3, 1, {0x10}},
	{0x00, 1, {0x8A}},
	{0xC0, 1, {0x1C}},
	{0xC0, 1, {0x05}},
	{0x00, 1, {0xB0}},
	{0xF3, 1, {0x01}},
	{0xF3, 1, {0xFE}},
	{0x11, 0, {}},
	{REGFLAG_DELAY, 120, {}},
	{0x29, 0, {}},
	{0x35, 1, {0x1}},
};

static struct LCM_setting_table lcm_suspend_setting[] = {
	{0x28, 1, {0x00}},
	{REGFLAG_DELAY, 60, {}},
	{0x10, 1, {0x00}},
	{REGFLAG_DELAY, 60, {}},
	{0x00, 1, {0x00}},
	{0xFF, 1, {0x87}},
	{0xFF, 1, {0x19}},
	{0xFF, 1, {0x01}},
	{0x00, 1, {0x80}},
	{0xFF, 1, {0x87}},
	{0xFF, 1, {0x19}},
	{0x00, 1, {0x00}},
	{0xF7, 1, {0x5A}},
	{0xF7, 1, {0xA5}},
	{0xF7, 1, {0x95}},
	{0xF7, 1, {0x27}},
};

/* ------------------------------------------------------------------------- */
/* LCM Driver Implementation                                                 */
/* ------------------------------------------------------------------------- */

static void lcm_set_util_funcs(const LCM_UTIL_FUNCS *util)
{
	memcpy(&lcm_util, util, sizeof(LCM_UTIL_FUNCS));
}

static void lcm_get_params(LCM_PARAMS *params)
{
	memset(params, 0, sizeof(LCM_PARAMS));

	params->type = LCM_TYPE_DSI;

	/* Video Mode Settings */
	params->width = FRAME_WIDTH;
	params->height = FRAME_HEIGHT;
	params->physical_width = 67;
	params->physical_height = 145;

	/* Enable Tearing-Free */
	params->dbi.te_mode = LCM_DBI_TE_MODE_DISABLED;
	params->dbi.te_edge_polarity = LCM_POLARITY_RISING;

	params->dsi.mode = SYNC_PULSE_VDO_MODE;

	/* DSI */
	/* Command mode setting */
	params->dsi.LANE_NUM = LCM_FOUR_LANE;

	/* The following defined the fomat for data coming from LCD engine. */
	params->dsi.data_format.color_order = LCM_COLOR_ORDER_RGB;
	params->dsi.data_format.trans_seq = LCM_DSI_TRANS_SEQ_MSB_FIRST;
	params->dsi.data_format.padding = LCM_DSI_PADDING_ON_LSB;
	params->dsi.data_format.format = LCM_DSI_FORMAT_RGB888;

	params->dsi.PS = LCM_PACKED_PS_24BIT_RGB888;
	params->dsi.intermediat_buffer_num = 0;

	/* Highly depends on LCD driver capability. */
	params->dsi.packet_size = 256;

	/* Video Mode Timing */

	/* Vertical */
	params->dsi.vertical_sync_active = 9;
	params->dsi.vertical_backporch = 54;
	params->dsi.vertical_frontporch = 114;
	params->dsi.vertical_active_line = FRAME_HEIGHT;

	/* Horizontal */
	params->dsi.horizontal_sync_active = 6;
	params->dsi.horizontal_backporch = 16;
	params->dsi.horizontal_frontporch = 104;
	params->dsi.horizontal_active_pixel = FRAME_WIDTH;

	params->dsi.PLL_CLOCK = 599;
	params->dsi.ssc_disable = 1;
	params->dsi.cont_clock = 1;
	params->dsi.clk_lp_per_line_enable = 0;
	params->dsi.esd_check_enable = 1;
	params->dsi.customization_esd_check_enable = 1;
	params->dsi.lcm_esd_check_table[0].cmd = 0x0a;
	params->dsi.lcm_esd_check_table[0].count = 1;
	params->dsi.lcm_esd_check_table[0].para_list[0] = 0x9c;
}

static void lcm_init(void)
{
	SET_RESET_PIN(0);
	MDELAY(10);
	set_gpio_lcd_enn(1);
	MDELAY(10);

	PMU_db_pos_neg_setting_delay_hct(10, 58);

	MDELAY(5);
	SET_RESET_PIN(1);
	MDELAY(5);
	SET_RESET_PIN(0);
	MDELAY(5);
	SET_RESET_PIN(1);
	MDELAY(120);

	push_table(lcm_init_setting,
			   sizeof(lcm_init_setting) / sizeof(struct LCM_setting_table),
			   1);
}

static void lcm_suspend(void)
{
	int ret;
	ret = fts_write_reg(0xA5, 0x03);
	if (ret > 0)
		printk("[LCM] failed to power off touch panel, ret=%d", ret);

	push_table(lcm_suspend_setting,
			   sizeof(lcm_suspend_setting) / sizeof(struct LCM_setting_table),
			   1);

	SET_RESET_PIN(0);
	MDELAY(5);
	PMU_db_pos_neg_disable_delay(10);
}

static void lcm_resume(void)
{
	lcm_init();
}

static unsigned int lcm_compare_id(void)
{
	// Display Power-On Sequence
	RT5081_db_pos_neg_setting_by_i2c(15);
	MDELAY(25);
	SET_RESET_PIN(1);
	MDELAY(5);
	SET_RESET_PIN(0);
	MDELAY(20);
	SET_RESET_PIN(1);

	// Always return 1 (id is valid) since BV9100
	// only uses one display panel.
	return 1;
}

LCM_DRIVER hct_ft8719p_dsi_vdo_fhdplus_jdi_63_hlt = {
	.name = "hct_ft8719p_dsi_vdo_fhdplus_jdi_63_hlt",
	.init = lcm_init,
	.suspend = lcm_suspend,
	.resume = lcm_resume,
	.get_params = lcm_get_params,
	.set_util_funcs = lcm_set_util_funcs,
	.compare_id = lcm_compare_id
};
